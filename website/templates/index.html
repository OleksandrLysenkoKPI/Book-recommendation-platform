{% extends 'base/base.html' %}
{% block title %}Домашня сторінка{% endblock %}
{% block content %}
<h1 class="mb-4">Книжки</h1>

<div class="d-flex flex-wrap justify-content-start gap-4">
  {% for book in books %}
  <div class="card mb-4 mx-1" style="width: 20rem;">
    <div class="position-relative">
      {% if book.img %}
      <img class="card-img-top custom-img-size" style="object-fit: cover; height: 300px;"
        src="{{ url_for('static', filename = 'images/books/'+book.img) }}" alt="{{ book.img }}" />
      {% endif %}

      <!-- Кнопки поверх зображення -->
      <!-- Кнопка "Улюблене" -->
      <button id="fav-btn-{{ book._id }}" onclick="toggleFavourite('{{ book._id }}')" type="button"
        class="btn btn-sm btn-light position-absolute m-2" style="opacity: 0.85; right: 0; top: 0;">
        <i class="bi {% if book._id in user_fav_books %}bi-heart-fill{% else %}bi-heart{% endif %}"></i>
      </button>

      <!-- Кнопка "Прочитане" -->
      <button id="read-btn-{{ book._id }}" onclick="toggleRead('{{ book._id }}')" type="button"
        class="btn btn-sm btn-light position-absolute m-2" style="opacity: 0.85; left: 0; top: 0;">
        <i class="bi {% if book._id in user_read_books %}bi-book-fill{% else %}bi-book{% endif %}"></i>
      </button>
    </div>

    <div class="card-body d-flex flex-column">
      <h5 class="card-title">
        <a href="{{ url_for('views.book_detail', book_id=book._id) }}" class="text-decoration-none">
          {{ book.title }}
        </a>
      </h5>
      <p class="card-text"><strong>Автор:</strong> {{ book.author }}</p>
      <p class="card-text"><strong>Рейтинг:</strong> {{ book.rating }}⭐</p>
      <p class="card-text">{{ book.description[:150] }}...</p>

      {% if book.genre %}
      <p class="card-text">
        <small class="text-muted">Жанри: {{ book.genre | join(', ') }}</small>
      </p>
      {% endif %}
    </div>
  </div>

  {% endfor %}
</div>
<div class="container">
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center mt-4">
      {% if page > 1 %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('views.index', page=page-1, sort=sort_by, q=q) }}">Попередня</a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <span class="page-link">Попередня</span>
      </li>
      {% endif %}

      {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if page == p %}active{% endif %}">
        <a class="page-link" href="{{ url_for('views.index', page=p, sort=sort_by, q=q) }}">{{ p }}</a>
      </li>
      {% endfor %}

      {% if page < total_pages %} <li class="page-item">
        <a class="page-link" href="{{ url_for('views.index', page=page+1, sort=sort_by, q=q) }}">Наступна</a>
        </li>
        {% else %}
        <li class="page-item disabled">
          <span class="page-link">Наступна</span>
        </li>
        {% endif %}
    </ul>
  </nav>
</div>
{% endblock %}